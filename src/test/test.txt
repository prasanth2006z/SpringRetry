
<bean id="X509TrustManager"
		class="com.equifax.ic.saas.client.integration.ig.handlers.AllowAllX509TrustManager" />

	<bean id="sslContext" class="javax.net.ssl.SSLContext"
		factory-method="getInstance">
		<constructor-arg type="java.lang.String" value="SSL" />
	</bean>

	<bean
		class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
		<property name="targetObject">
			<ref bean="sslContext" />
		</property>
		<property name="targetMethod" value="init" />
		<property name="arguments">
			<list>
				<null />
				<array>
					<ref bean="X509TrustManager" />
				</array>
				<null />
			</list>
		</property>
	</bean>

 

	<bean id="noopHostnameVerifier" class="org.apache.http.conn.ssl.NoopHostnameVerifier" />

	<bean id="sslConnectionSocketFactory" class="org.apache.http.conn.ssl.SSLConnectionSocketFactory" >
	    <constructor-arg ref="sslContext" />
	    <constructor-arg ref="noopHostnameVerifier" />
	</bean>

	<bean id="registryBuilder" class="org.apache.http.config.RegistryBuilder" factory-method="create"/>

	<bean id="socketFactoryRegistryBuilder" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean" >
		<property name="targetObject" ref="registryBuilder" />
	    <property name="targetMethod" value="register" />
		<property name="arguments">
			<list>
				<value>https</value>
				<ref bean="sslConnectionSocketFactory" />
			</list>
		</property>
	 </bean>

	<bean id="socketFactoryRegistry" factory-bean="socketFactoryRegistryBuilder" factory-method="build" />

	<bean id="globalConnectionManager" class="org.apache.http.impl.conn.PoolingHttpClientConnectionManager">
		<constructor-arg ref="socketFactoryRegistry" />
		<property name="maxTotal" value="${httpclient.maxtotal}" />
		<property name="defaultMaxPerRoute" value="${httpclient.defaultmaxperroute}" />
	</bean>

	<bean id="globalHttpClientBuilder" class="org.apache.http.impl.client.HttpClientBuilder" factory-method="create">
		<property name="sSLContext" ref="sslContext" />
		<property name="connectionManager" ref="globalConnectionManager"/>
	</bean>

	<bean id="globalHttpsClient" factory-bean="globalHttpClientBuilder" factory-method="build" />

	


	<bean id="serviceResponseErrorHandler"
		class="com.equifax.ic.saas.client.integration.error.handler.ServiceResponseErrorHandler" />

	<bean id="restTemplate" class="org.springframework.web.client.RestTemplate">
		<constructor-arg>
			<bean
				class="org.springframework.http.client.HttpComponentsClientHttpRequestFactory">
				<constructor-arg ref="globalHttpsClient" />
				<property name="readTimeout" value="${ig.read.timeout}" />
				<property name="connectTimeout" value="${ig.connect.timeout}" />
			</bean>
		</constructor-arg>
		<property name="errorHandler" ref="serviceResponseErrorHandler" />
	</bean>

	
	<bean id="rulesHttpsClient" factory-bean="globalHttpClientBuilder" factory-method="build" />

	<bean id="rulesRestTemplate" class="org.springframework.web.client.RestTemplate">
		<constructor-arg>
			<bean
				class="org.springframework.http.client.HttpComponentsClientHttpRequestFactory">
				<constructor-arg ref="rulesHttpsClient" />
				<property name="readTimeout" value="${rules.read.timeout}" />
				<property name="connectTimeout" value="${rules.connect.timeout}" />
			</bean>
		</constructor-arg>
		<property name="errorHandler" ref="serviceResponseErrorHandler" />
	</bean>

=============================
<bean id="plainConnectionSocketFactory" class="org.apache.http.conn.socket.PlainConnectionSocketFactory" factory-method="getSocketFactory"/>    

        

        <bean id="registryBuilder" class="org.apache.http.config.RegistryBuilder" factory-method="create"/>     

<bean class="org.springframework.beans.factory.config.MethodInvokingFactoryBean" >

                <property name="targetObject" ref="registryBuilder" />

            <property name="targetMethod" value="register" />

                <property name="arguments">

                        <list>

                                <value>http</value>

                                <ref bean="plainConnectionSocketFactory" />

                        </list>

                </property>

         </bean>

